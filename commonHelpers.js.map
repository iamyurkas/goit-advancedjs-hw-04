{"version":3,"file":"commonHelpers.js","sources":["../src/js/index.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst refs = {\n  form: document.querySelector('#search-form'),\n  input: document.querySelector('input'),\n  gallery: document.querySelector('.gallery'),\n  loadBtn: document.querySelector('.load-more'),\n};\n\niziToast.settings({\n  timeout: 2000,\n  position: 'topRight',\n  transitionIn: 'fadeInRight',\n  transitionOut: 'fadeOutLeft',\n  maxWidth: 350,\n});\n\nvar lightbox = new SimpleLightbox('.photo-card a', {});\n\nlet cardHeight;\nconst perPage = 40;\nlet page = 1;\nlet tag;\n\nrefs.form.addEventListener('submit', handlerSearchPhoto);\nrefs.loadBtn.addEventListener('click', handlerLoadMore);\n\nasync function handlerSearchPhoto(evt) {\n  evt.preventDefault();\n  tag = refs.form[0].value.trim().toLowerCase();\n  refs.loadBtn.classList.add('hidden');\n  if (tag) {\n    page = 1;\n\n    refs.form.reset();\n\n    try {\n      const data = await servicePhoto(tag, page, perPage);\n      if (!data.hits.length) {\n        iziToast.error({\n          message:\n            'Sorry, there are no images matching your search query. Please try again.',\n        });\n        refs.gallery.innerHTML = '<div></div>';\n        return;\n      }\n\n      iziToast.success({\n        message: `Hooray! We found ${data.totalHits} images.`,\n      });\n      refs.gallery.innerHTML = createMarkupGallary(data.hits);\n      lightbox.refresh();\n    } catch {\n      err => console.log(err);\n    }\n  } else {\n    iziToast.warning({\n      message: 'Fill in the search field!',\n    });\n    refs.gallery.innerHTML = '<div></div>';\n  }\n}\n\nasync function handlerLoadMore() {\n  page += 1;\n\n  try {\n    const data = await servicePhoto(tag, page, perPage);\n    refs.gallery.insertAdjacentHTML(\n      'beforeend',\n      createMarkupGallary(data.hits)\n    );\n    lightbox.refresh();\n    cardHeight = refs.gallery.firstElementChild.getBoundingClientRect();\n    scrollBy({\n      top: cardHeight.height * 3,\n      behavior: 'smooth',\n    });\n\n    if (page >= data.totalHits / perPage) {\n      refs.loadBtn.classList.add('hidden');\n    }\n  } catch {\n    err => console.log(err);\n  }\n}\n\nfunction createMarkupGallary(arr) {\n  return arr\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `\n    <div class=\"photo-card\">\n        <a class=\"gallery-link\" href=\"${largeImageURL}\">\n            <div class=\"thumb\">\n                <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" width=\"360\" />\n            </div>\n                <div class=\"info\">\n                    <p class=\"info-item\">\n                        <b>Likes</b> ${likes}\n                    </p>\n                    <p class=\"info-item\">\n                        <b>Views</b> ${views}\n                    </p>\n                    <p class=\"info-item\">\n                        <b>Comments</b> ${comments}\n                    </p>\n                    <p class=\"info-item\">\n                        <b>Downloads</b> ${downloads}\n                    </p>\n            </div>\n        </a>\n    </div>\n    `\n    )\n    .join('');\n}\n\nasync function servicePhoto(q, page = 1, per_page) {\n  const options = {\n    params: {\n      key: '42322545-3f83537899e903f7192654afe',\n      q,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      per_page: 40,\n      page,\n    },\n  };\n\n  const { data } = await axios.get('https://pixabay.com/api/', options);\n\n  if (page <= data.totalHits / per_page) {\n    refs.loadBtn.classList.remove('hidden');\n  } else if (data.totalHits) {\n    iziToast.error({\n      message: \"We're sorry, but you've reached the end of search results.\",\n    });\n  }\n\n  return data;\n}\n"],"names":["refs","iziToast","lightbox","SimpleLightbox","cardHeight","perPage","page","tag","handlerSearchPhoto","handlerLoadMore","evt","data","servicePhoto","createMarkupGallary","arr","webformatURL","largeImageURL","tags","likes","views","comments","downloads","q","per_page","options","axios"],"mappings":"owBAMA,MAAMA,EAAO,CACX,KAAM,SAAS,cAAc,cAAc,EAC3C,MAAO,SAAS,cAAc,OAAO,EACrC,QAAS,SAAS,cAAc,UAAU,EAC1C,QAAS,SAAS,cAAc,YAAY,CAC9C,EAEAC,EAAS,SAAS,CAChB,QAAS,IACT,SAAU,WACV,aAAc,cACd,cAAe,cACf,SAAU,GACZ,CAAC,EAED,IAAIC,EAAW,IAAIC,EAAe,gBAAiB,CAAE,CAAA,EAErD,IAAIC,EACJ,MAAMC,EAAU,GAChB,IAAIC,EAAO,EACPC,EAEJP,EAAK,KAAK,iBAAiB,SAAUQ,CAAkB,EACvDR,EAAK,QAAQ,iBAAiB,QAASS,CAAe,EAEtD,eAAeD,EAAmBE,EAAK,CAIrC,GAHAA,EAAI,eAAc,EAClBH,EAAMP,EAAK,KAAK,CAAC,EAAE,MAAM,KAAI,EAAG,cAChCA,EAAK,QAAQ,UAAU,IAAI,QAAQ,EAC/BO,EAAK,CACPD,EAAO,EAEPN,EAAK,KAAK,QAEV,GAAI,CACF,MAAMW,EAAO,MAAMC,EAAaL,EAAKD,EAAMD,CAAO,EAClD,GAAI,CAACM,EAAK,KAAK,OAAQ,CACrBV,EAAS,MAAM,CACb,QACE,0EACZ,CAAS,EACDD,EAAK,QAAQ,UAAY,cACzB,MACD,CAEDC,EAAS,QAAQ,CACf,QAAS,oBAAoBU,EAAK,SAAS,UACnD,CAAO,EACDX,EAAK,QAAQ,UAAYa,EAAoBF,EAAK,IAAI,EACtDT,EAAS,QAAO,CACtB,MAAY,CAEP,CACL,MACID,EAAS,QAAQ,CACf,QAAS,2BACf,CAAK,EACDD,EAAK,QAAQ,UAAY,aAE7B,CAEA,eAAeS,GAAkB,CAC/BH,GAAQ,EAER,GAAI,CACF,MAAMK,EAAO,MAAMC,EAAaL,EAAKD,EAAMD,CAAO,EAClDL,EAAK,QAAQ,mBACX,YACAa,EAAoBF,EAAK,IAAI,CACnC,EACIT,EAAS,QAAO,EAChBE,EAAaJ,EAAK,QAAQ,kBAAkB,sBAAqB,EACjE,SAAS,CACP,IAAKI,EAAW,OAAS,EACzB,SAAU,QAChB,CAAK,EAEGE,GAAQK,EAAK,UAAYN,GAC3BL,EAAK,QAAQ,UAAU,IAAI,QAAQ,CAEzC,MAAU,CAEP,CACH,CAEA,SAASa,EAAoBC,EAAK,CAChC,OAAOA,EACJ,IACC,CAAC,CACC,aAAAC,EACA,cAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACR,IAAY;AAAA;AAAA,wCAE4BL,CAAa;AAAA;AAAA,4BAEzBD,CAAY,UAAUE,CAAI;AAAA;AAAA;AAAA;AAAA,uCAIfC,CAAK;AAAA;AAAA;AAAA,uCAGLC,CAAK;AAAA;AAAA;AAAA,0CAGFC,CAAQ;AAAA;AAAA;AAAA,2CAGPC,CAAS;AAAA;AAAA;AAAA;AAAA;AAAA,KAM/C,EACA,KAAK,EAAE,CACZ,CAEA,eAAeT,EAAaU,EAAGhB,EAAO,EAAGiB,EAAU,CACjD,MAAMC,EAAU,CACd,OAAQ,CACN,IAAK,qCACL,EAAAF,EACA,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAU,GACV,KAAAhB,CACD,CACL,EAEQ,CAAE,KAAAK,CAAI,EAAK,MAAMc,EAAM,IAAI,2BAA4BD,CAAO,EAEpE,OAAIlB,GAAQK,EAAK,UAAYY,EAC3BvB,EAAK,QAAQ,UAAU,OAAO,QAAQ,EAC7BW,EAAK,WACdV,EAAS,MAAM,CACb,QAAS,4DACf,CAAK,EAGIU,CACT"}